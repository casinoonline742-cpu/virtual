<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Monopolio Mario</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root { --bg: #121212; --panel: #1e1e1e; --gold: #FFD700; --green: #00e676; --red: #ff5252; }
        
        body { 
            background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; 
            margin: 0; padding: 0; min-height: 100vh; display: flex; flex-direction: column;
            overflow-x: hidden; overflow-y: auto; 
        }

        .top-bar { 
            background: #000; padding: 10px; display: flex; justify-content: space-between; align-items: center; 
            border-bottom: 2px solid var(--gold); height: 50px; position: sticky; top: 0; z-index: 500;
        }
        .btn-salir { color: #aaa; text-decoration: none; border: 1px solid #333; padding: 5px 10px; border-radius: 4px; font-size: 0.9em; }

        .main-container { width: 100%; max-width: 600px; margin: 0 auto; display: flex; flex-direction: column; padding-bottom: 40px; }
        .view { display: none; width: 100%; flex-direction: column; align-items: center; }
        .active { display: flex; }

        /* LOBBY */
        .lobby-box { background: var(--panel); padding: 30px; border-radius: 15px; text-align: center; width: 90%; max-width: 400px; border: 1px solid #444; margin-top: 40px; }
        input { width: 100%; padding: 12px; margin: 10px 0; text-align: center; background: #111; border: 1px solid var(--gold); color: white; border-radius: 5px; box-sizing: border-box; }
        .btn-main { background: var(--gold); color: black; border: none; padding: 12px; font-weight: bold; border-radius: 25px; cursor: pointer; width: 100%; margin-top: 10px; font-size: 1em; }
        .btn-sec { background: #333; color: white; border: 1px solid #555; }
        .btn-bot { background: #2c3e50; color: #3498db; border: 1px solid #3498db; margin-top: 5px; width: 100%; padding: 10px; border-radius: 25px; cursor: pointer; font-weight: bold; }

        /* TABLERO */
        .board-wrapper { width: 96%; margin: 10px auto; position: relative; }
        .board-container {
            width: 100%; aspect-ratio: 6/5; display: grid; 
            grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 0; 
            background-image: url('tablero monopoli.jpg'); background-size: 100% 100%;
            border-radius: 8px; box-shadow: 0 0 15px rgba(0,0,0,0.8); position: relative;
        }

        .board-center {
            grid-column: 3 / span 2; grid-row: 3 / span 2;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            width: 80%; height: 80%; margin: auto;
            background: rgba(0, 0, 0, 0.85); border-radius: 50%;
            border: 2px solid rgba(255, 215, 0, 0.3); backdrop-filter: blur(2px); z-index: 40;
            text-align: center;
        }

        .space { position: relative; width: 100%; height: 100%; }
        .owned-mark { 
            position: absolute; top: 2px; left: 2px; right: 2px; bottom: 2px;
            border: 0px solid transparent; border-radius: 4px; pointer-events: none; transition: all 0.3s;
        }
        .token {
            width: 30%; height: 30%; border-radius: 50%; border: 2px solid white;
            position: absolute; z-index: 20; transition: all 0.4s ease-out;
            box-shadow: 0 2px 4px rgba(0,0,0,0.9); top: 50%; left: 50%; transform: translate(-50%, -50%);
        }

        /* CONTROLES */
        #turn-msg { color: var(--gold); font-weight: bold; margin-bottom: 2px; font-size: 0.7em; text-transform: uppercase; }
        #dice-btn { 
            width: 50px; height: 50px; background: white; color: black; border-radius: 10px;
            font-size: 2em; font-weight: bold; display: flex; align-items: center; justify-content: center;
            cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        .shaking { animation: shake 0.5s infinite; background: #ffffcc !important; }
        
        .action-area { 
            position: absolute; bottom: -60px; left: 50%; transform: translateX(-50%);
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            width: 280px; z-index: 100; text-align: center;
        }
        
        .btn-buy { background: var(--green); color: black; padding: 8px 16px; border-radius: 20px; border: 2px solid white; font-weight: bold; font-size: 0.8em; cursor: pointer; box-shadow: 0 4px 8px black; margin-bottom: 5px; }
        .rent-hint { font-size: 0.75em; color: #ccc; background: rgba(0,0,0,0.7); padding: 2px 6px; border-radius: 4px; margin-top: 2px;}
        
        .msg-pay { background: rgba(0,0,0,0.9); padding: 10px; border-radius: 10px; border: 1px solid var(--red); color: white; font-size: 0.8em; animation: fadeIn 0.3s; }
        .pay-amount { color: var(--red); font-weight: bold; font-size: 1.2em; display: block; margin: 5px 0;}
        .new-balance { color: var(--green); font-weight: bold; }

        /* LISTA JUGADORES */
        .players-panel { width: 94%; margin: 70px auto 20px auto; background: #111; border-radius: 12px; border: 1px solid #333; padding: 15px; }
        .panel-title { color: #888; font-size: 0.8em; font-weight: bold; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px;}
        .players-grid { display: flex; flex-direction: column; gap: 8px; }
        .p-row { display: flex; justify-content: space-between; align-items: center; background: #222; padding: 10px; border-radius: 8px; border-left: 4px solid transparent; }
        .p-row.active { background: #2a2a2a; border-left: 4px solid var(--gold); border: 1px solid var(--gold); }
        .p-info { display: flex; align-items: center; gap: 10px; }
        .p-money { color: var(--green); font-weight: bold; }

        /* ESPERA */
        .waiting-list { width: 90%; background: #111; padding: 10px; border-radius: 10px; margin: 20px 0; }
        .player-item { padding: 10px; border-bottom: 1px solid #333; display: flex; align-items: center; gap: 10px; }

        @keyframes shake { 0% { transform: rotate(0); } 25% { transform: rotate(10deg); } 75% { transform: rotate(-10deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="top-bar">
        <span>üçÑ MONOPOLIO MARIO</span>
        <a href="index.html" class="btn-salir">Salir</a>
    </div>

    <div class="main-container">
        
        <div id="view-login" class="view active">
            <div class="lobby-box">
                <h2 style="color:var(--gold)">SALA DE JUEGO</h2>
                <input type="text" id="input-nombre" placeholder="Tu Nombre">
                <button class="btn-main" onclick="crearSala()">CREAR PARTIDA</button>
                <div style="margin:10px">- O -</div>
                <input type="number" id="input-codigo" placeholder="C√≥digo Sala">
                <button class="btn-main btn-sec" onclick="unirseSala()">UNIRSE</button>
            </div>
        </div>

        <div id="view-waiting" class="view">
            <h2 style="color:var(--gold)">SALA: <span id="lbl-room-id">...</span></h2>
            <p>Esperando jugadores...</p>
            <div id="waiting-list" class="waiting-list"></div>
            
            <div id="host-controls" style="display:none; width: 80%;">
                <button class="btn-bot" onclick="agregarBot()">+ A√ëADIR BOT ü§ñ</button>
                <button class="btn-main" onclick="iniciarPartida()">INICIAR JUEGO</button>
            </div>
            <div id="guest-msg" style="display:none; color:#aaa; font-style: italic;">Esperando al anfitri√≥n...</div>
        </div>

        <div id="view-game" class="view">
            
            <div class="board-wrapper">
                <div class="board-container" id="board">
                    <div class="board-center">
                        <div id="turn-msg">...</div>
                        <div id="dice-btn" onclick="lanzarDadoHumano()">üé≤</div>
                        
                        <div id="action-zone" class="action-area"></div>
                    </div>
                </div>
            </div>

            <div class="players-panel">
                <div class="panel-title">JUGADORES Y DINERO üí∞</div>
                <div id="ingame-players" class="players-grid"></div>
            </div>

        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB4a3J_fGDd-r99EKT929bmB_Y08TJ3t2g",
            authDomain: "casino-familia.firebaseapp.com",
            databaseURL: "https://casino-familia-default-rtdb.firebaseio.com",
            projectId: "casino-familia",
            storageBucket: "casino-familia.firebasestorage.app",
            messagingSenderId: "390973825874",
            appId: "1:390973825874:web:ddc9f9d0d64bebf9c2908b"
        };
        try { firebase.initializeApp(firebaseConfig); } catch(e) {}
        const db = firebase.database();

        // DATOS DEL TABLERO
        const BOARD_DATA = [
            { name: "SALIDA", type: 'corner' }, // 0
            { name: "AV. 1", price: 60, rent: 10, type: 'prop' }, // 1
            { name: "AV. 2", price: 60, rent: 12, type: 'prop' }, // 2
            { name: "TREN", price: 200, rent: 50, type: 'prop' }, // 3
            { name: "PLAZA", price: 100, rent: 15, type: 'prop' }, // 4
            { name: "C√ÅRCEL", type: 'corner' }, // 5
            { name: "MUSEO", price: 140, rent: 20, type: 'prop' }, // 6
            { name: "CINE", price: 160, rent: 22, type: 'prop' }, // 7
            { name: "LUZ", price: 150, rent: 30, type: 'prop' }, // 8
            { name: "CLUB", price: 200, rent: 30, type: 'prop' }, // 9
            { name: "PARKING", type: 'corner' }, // 10
            { name: "HOTEL", price: 220, rent: 35, type: 'prop' }, // 11
            { name: "CASINO", price: 240, rent: 40, type: 'prop' }, // 12
            { name: "TREN 2", price: 200, rent: 50, type: 'prop' }, // 13
            { name: "JARD√çN", price: 260, rent: 45, type: 'prop' }, // 14
            { name: "IR A C√ÅRCEL", type: 'corner' }, // 15
            { name: "PLAYA", price: 300, rent: 50, type: 'prop' }, // 16
            { name: "MANSI√ìN", price: 320, rent: 55, type: 'prop' }, // 17
            { name: "IMPUESTO", price: 0, rent: 100, type: 'tax' }, // 18
            { name: "TORRE", price: 400, rent: 70, type: 'prop' } // 19
        ];

        const GRID_POS = [
            {r:6, c:6}, {r:6, c:5}, {r:6, c:4}, {r:6, c:3}, {r:6, c:2}, // Abajo
            {r:6, c:1}, // Esq Inf Izq
            {r:5, c:1}, {r:4, c:1}, {r:3, c:1}, {r:2, c:1}, // Izquierda
            {r:1, c:1}, // Esq Sup Izq
            {r:1, c:2}, {r:1, c:3}, {r:1, c:4}, {r:1, c:5}, // Arriba
            {r:1, c:6}, // Esq Sup Der
            {r:2, c:6}, {r:3, c:6}, {r:4, c:6}, {r:5, c:6}  // Derecha
        ];

        let myName = "", myId = "", roomId = "", isHost = false;
        let players = [], turnIndex = 0, properties = {};
        const PLAYER_COLORS = ['#ff5252', '#448aff', '#69f0ae', '#ffd740'];

        function initBoard() {
            const boardDiv = document.getElementById('board');
            document.querySelectorAll('.space').forEach(e => e.remove());
            BOARD_DATA.forEach((data, i) => {
                const pos = GRID_POS[i];
                const div = document.createElement('div');
                div.className = 'space';
                div.id = 'space-' + i;
                div.style.gridRow = pos.r;
                div.style.gridColumn = pos.c;
                div.innerHTML = `<div id="owner-${i}" class="owned-mark"></div>`;
                boardDiv.appendChild(div);
            });
        }

        // --- SALA ---
        function crearSala() {
            myName = document.getElementById('input-nombre').value.trim();
            if(!myName) return alert("Nombre obligatorio");
            roomId = Math.floor(1000 + Math.random() * 9000).toString();
            myId = 'host'; isHost = true;
            let props = {}; for(let i=0; i<20; i++) props[i] = "";
            db.ref('monopoly/' + roomId).set({
                status: 'waiting', currentTurn: 0, props: props,
                players: { [myId]: { name: myName, money: 1500, pos: 0, color: PLAYER_COLORS[0], isBot: false } }
            });
            mostrarLobby();
        }

        function unirseSala() {
            myName = document.getElementById('input-nombre').value.trim();
            roomId = document.getElementById('input-codigo').value.trim();
            if(!myName || !roomId) return alert("Faltan datos");
            myId = 'p_' + Date.now();
            db.ref('monopoly/' + roomId).once('value').then(snap => {
                if(!snap.exists()) return alert("Sala no existe");
                const count = Object.keys(snap.val().players).length;
                if(count >= 4) return alert("Sala llena");
                db.ref('monopoly/' + roomId + '/players/' + myId).set({
                    name: myName, money: 1500, pos: 0, color: PLAYER_COLORS[count], isBot: false
                });
                mostrarLobby();
            });
        }

        function agregarBot() {
            db.ref('monopoly/' + roomId + '/players').once('value').then(snap => {
                const count = Object.keys(snap.val()).length;
                if(count >= 4) return alert("Sala llena");
                const botId = 'bot_' + Date.now();
                db.ref('monopoly/' + roomId + '/players/' + botId).set({
                    name: "Bot " + (count), money: 1500, pos: 0, color: PLAYER_COLORS[count], isBot: true
                });
            });
        }

        function mostrarLobby() {
            document.getElementById('view-login').classList.remove('active');
            document.getElementById('view-waiting').classList.add('active');
            document.getElementById('lbl-room-id').innerText = roomId;
            if(isHost) document.getElementById('host-controls').style.display = 'block';
            else document.getElementById('guest-msg').style.display = 'block';

            db.ref('monopoly/' + roomId + '/players').on('value', snap => {
                const list = document.getElementById('waiting-list');
                list.innerHTML = "";
                players = [];
                snap.forEach(c => {
                    const p = c.val(); p.id = c.key; players.push(p);
                    list.innerHTML += `<div class="player-item"><div class="avatar-dot" style="background:${p.color}"></div><b>${p.name}</b> ${p.isBot ? 'ü§ñ' : ''}</div>`;
                });
            });

            db.ref('monopoly/' + roomId + '/status').on('value', snap => {
                if(snap.val() === 'playing') iniciarJuegoUI();
            });
        }

        function iniciarPartida() {
            db.ref('monopoly/' + roomId).update({ status: 'playing' });
        }

        // --- JUEGO ---
        function iniciarJuegoUI() {
            document.getElementById('view-waiting').classList.remove('active');
            document.getElementById('view-game').classList.add('active');
            initBoard();

            db.ref('monopoly/' + roomId).on('value', snap => {
                const data = snap.val();
                if(!data) return;

                players = [];
                const listDiv = document.getElementById('ingame-players');
                listDiv.innerHTML = "";
                
                Object.keys(data.players).forEach((key, idx) => {
                    let p = data.players[key]; p.id = key; players.push(p);
                    listDiv.innerHTML += `
                        <div class="p-row ${idx === data.currentTurn ? 'active' : ''}">
                            <div class="p-info">
                                <div class="avatar-dot" style="background:${p.color}"></div>
                                <span>${p.name} ${p.isBot?'ü§ñ':''}</span>
                            </div>
                            <span class="p-money">$${p.money}</span>
                        </div>
                    `;
                });

                turnIndex = data.currentTurn;
                properties = data.props || {};

                renderTokens();
                renderOwners();
                updateControls();

                if(isHost && data.status === 'playing') {
                    const curr = players[turnIndex];
                    if(curr && curr.isBot) procesarTurnoBot(curr.id);
                }
            });
        }

        function renderTokens() {
            document.querySelectorAll('.token').forEach(e => e.remove());
            players.forEach((p, i) => {
                const space = document.getElementById('space-' + p.pos);
                if(space) {
                    const t = document.createElement('div');
                    t.className = 'token';
                    t.style.backgroundColor = p.color;
                    
                    // Posicionamiento preciso
                    const slot = i % 4; // 0, 1, 2, 3
                    if (slot === 0) { t.style.top = '25%'; t.style.left = '25%'; }
                    if (slot === 1) { t.style.top = '25%'; t.style.left = '75%'; }
                    if (slot === 2) { t.style.top = '75%'; t.style.left = '25%'; }
                    if (slot === 3) { t.style.top = '75%'; t.style.left = '75%'; }
                    
                    space.appendChild(t);
                }
            });
        }

        function renderOwners() {
            for(let i=0; i<20; i++) {
                const border = document.getElementById('owner-'+i);
                if(properties[i]) {
                    const owner = players.find(p => p.id === properties[i]);
                    if(owner) {
                        border.style.borderWidth = "4px";
                        border.style.borderColor = owner.color;
                        border.style.boxShadow = `inset 0 0 10px ${owner.color}`;
                    }
                } else {
                    border.style.borderColor = 'transparent';
                    border.style.boxShadow = 'none';
                }
            }
        }

        function updateControls() {
            const turnMsg = document.getElementById('turn-msg');
            const diceBtn = document.getElementById('dice-btn');
            
            const curr = players[turnIndex];
            if(!curr) return;

            if(curr.id === myId) {
                turnMsg.innerText = "TU TURNO";
                diceBtn.style.opacity = 1; diceBtn.style.pointerEvents = 'all';
            } else {
                turnMsg.innerText = `TURNO: ${curr.name}`;
                diceBtn.style.opacity = 0.3; diceBtn.style.pointerEvents = 'none';
            }
        }

        // --- ACCIONES ---
        function lanzarDadoHumano() {
            const diceBtn = document.getElementById('dice-btn');
            diceBtn.classList.add('shaking');
            diceBtn.style.pointerEvents = 'none';
            setTimeout(() => {
                diceBtn.classList.remove('shaking');
                const val = Math.floor(Math.random() * 6) + 1;
                diceBtn.innerText = val;
                moverFichaPasoAPaso(val, myId);
            }, 500);
        }

        let botProcessing = false;
        function procesarTurnoBot(botId) {
            if(botProcessing) return;
            botProcessing = true;
            setTimeout(() => {
                const btn = document.getElementById('dice-btn');
                btn.innerText = "ü§ñ";
                btn.classList.add('shaking');
                setTimeout(() => {
                    btn.classList.remove('shaking');
                    const val = Math.floor(Math.random() * 6) + 1;
                    btn.innerText = val;
                    moverFichaPasoAPaso(val, botId);
                    setTimeout(() => botProcessing = false, 4000); // Dar tiempo a la animaci√≥n de pago
                }, 1000);
            }, 1000);
        }

        function moverFichaPasoAPaso(pasos, pid) {
            let pIdx = players.findIndex(p => p.id === pid);
            let currentPos = players[pIdx].pos;
            
            let contador = 0;
            let intervalo = setInterval(() => {
                contador++;
                let nuevaPos = currentPos + contador;
                if(nuevaPos >= 20) {
                    nuevaPos = nuevaPos % 20;
                    // Vuelta (solo si soy due√±o o host para bot)
                    if(pid === myId || (isHost && players[pIdx].isBot)) {
                        let p = players.find(x => x.id === pid);
                        db.ref('monopoly/' + roomId + '/players/' + pid + '/money').set(p.money + 200);
                    }
                }
                db.ref('monopoly/' + roomId + '/players/' + pid).update({ pos: nuevaPos });
                if(navigator.vibrate) navigator.vibrate(20);

                if(contador >= pasos) {
                    clearInterval(intervalo);
                    setTimeout(() => evaluarCasilla(nuevaPos, pid), 500);
                }
            }, 300);
        }

        function evaluarCasilla(pos, pid) {
            const space = BOARD_DATA[pos];
            const actionZone = document.getElementById('action-zone');
            const isMe = (pid === myId);
            const player = players.find(p => p.id === pid);
            const currentMoney = player.money;

            // Limpiar zona
            actionZone.innerHTML = "";

            if(pos === 15) { // C√ÅRCEL
                if(isMe) alert("¬°A LA C√ÅRCEL!");
                db.ref('monopoly/' + roomId + '/players/' + pid).update({ pos: 5 });
                pasarTurno();
                return;
            }

            // IMPUESTO (AUTO)
            if(space.type === 'tax') {
                if(isMe || (player.isBot && isHost)) {
                    pagarBanco(space.rent, pid, "IMPUESTO");
                }
                return;
            }

            // PROPIEDAD
            if(space.type === 'prop') {
                const ownerId = properties[pos];
                
                // Sin due√±o -> COMPRAR (Manual para humano, Auto para Bot)
                if(!ownerId || ownerId === "") {
                    if(currentMoney >= space.price) {
                        if(isMe) {
                            actionZone.innerHTML = `
                                <div style="display:flex; flex-direction:column; align-items:center;">
                                    <button class="btn-buy" onclick="comprarPropiedad(${pos}, ${space.price}, '${pid}')">COMPRAR $${space.price}</button>
                                    <div class="rent-hint">Renta futura: $${space.rent}</div>
                                    <button class="btn-sec" onclick="pasarTurno()" style="margin-top:5px; padding:4px 10px; font-size:0.7em; border-radius:15px;">PASAR</button>
                                </div>
                            `;
                        } else if (player.isBot && isHost) {
                            setTimeout(() => comprarPropiedad(pos, space.price, pid), 1000);
                        }
                    } else {
                        // No alcanza
                        if(isMe) {
                            actionZone.innerHTML = `<span style="color:red; font-weight:bold; background:rgba(0,0,0,0.8); padding:5px; border-radius:5px;">Sin Dinero</span>`;
                            setTimeout(pasarTurno, 1500);
                        } else if(player.isBot && isHost) setTimeout(pasarTurno, 1000);
                    }
                } 
                // Con due√±o ajeno -> PAGAR AUTO
                else if(ownerId !== pid) {
                    if(isMe || (player.isBot && isHost)) {
                        pagarRenta(ownerId, space.rent, pid);
                    }
                } 
                // M√≠a
                else {
                    pasarTurno();
                }
            } else {
                if(isMe || (player.isBot && isHost)) setTimeout(pasarTurno, 1000);
            }
        }

        // --- TRANSACCIONES CON FEEDBACK ---

        function comprarPropiedad(pos, price, pid) {
            let p = players.find(x => x.id === pid);
            db.ref('monopoly/' + roomId + '/players/' + pid + '/money').set(p.money - price);
            db.ref('monopoly/' + roomId + '/props/' + pos).set(pid);
            pasarTurno();
        }

        function pagarRenta(ownerId, amount, pid) {
            let p = players.find(x => x.id === pid);
            let owner = players.find(x => x.id === ownerId);
            
            // UI Feedback
            const actionZone = document.getElementById('action-zone');
            const nuevoSaldo = p.money - amount;
            
            actionZone.innerHTML = `
                <div class="msg-pay">
                    Propiedad de ${owner.name}<br>
                    <span class="pay-amount">PAGASTE $${amount}</span>
                    <span class="new-balance">Saldo: $${nuevoSaldo}</span>
                </div>
            `;

            // Ejecutar pago real
            db.ref('monopoly/' + roomId + '/players/' + pid + '/money').set(nuevoSaldo);
            db.ref('monopoly/' + roomId + '/players/' + ownerId + '/money').set(owner.money + amount);
            
            // Esperar para leer y pasar
            setTimeout(() => {
                actionZone.innerHTML = "";
                pasarTurno();
            }, 2000);
        }

        function pagarBanco(amount, pid, motivo) {
            let p = players.find(x => x.id === pid);
            
            // UI Feedback
            const actionZone = document.getElementById('action-zone');
            const nuevoSaldo = p.money - amount;

            actionZone.innerHTML = `
                <div class="msg-pay">
                    ${motivo}<br>
                    <span class="pay-amount">-$${amount}</span>
                    <span class="new-balance">Saldo: $${nuevoSaldo}</span>
                </div>
            `;

            db.ref('monopoly/' + roomId + '/players/' + pid + '/money').set(nuevoSaldo);
            
            setTimeout(() => {
                actionZone.innerHTML = "";
                pasarTurno();
            }, 2000);
        }

        function pasarTurno() {
            document.getElementById('action-zone').innerHTML = "";
            let next = (turnIndex + 1) % players.length;
            db.ref('monopoly/' + roomId + '/currentTurn').set(next);
        }
    </script>
</body>
</html>